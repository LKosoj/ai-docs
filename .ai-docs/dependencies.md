# Зависимости

## Внешние зависимости

Инструмент `ai_docs` требует следующие внешние зависимости для корректной работы:

| Зависимость | Назначение | Обязательность |
|------------|----------|---------------|
| `git` | Клонирование удалённых Git-репозиториев при указании URL в `--source` | Обязательна при работе с удалёнными репозиториями |
| `python >= 3.9` | Выполнение CLI-инструмента и всех модулей | Обязательна |
| `pip` | Установка Python-пакетов | Обязательна |

## Python-пакеты (PyPI)

Основные зависимости, указанные в `requirements.txt` или `pyproject.toml`:

| Пакет | Назначение | Используется в |
|------|----------|----------------|
| `tiktoken` | Подсчёт и разбиение текста на токены в соответствии с моделью OpenAI | `tokenizer.py`, управление контекстным бюджетом |
| `PyYAML` | Парсинг и генерация YAML-файлов (`.ai-docs.yaml`, `mkdocs.yml`) | `config.py`, `mkdocs_builder.py`, `scanner.py` |
| `pathspec` | Сопоставление путей с шаблонами `.gitignore` и `.build_ignore` | `scanner.py`, фильтрация файлов |
| `python-dotenv` | Загрузка переменных окружения из `.env` | `main.py`, инициализация LLM-настроек |
| `requests` | HTTP-запросы к OpenAI-совместимому API | `llm_client.py` |

## Условные зависимости

| Сценарий | Требуемые пакеты |
|--------|------------------|
| Генерация MkDocs-сайта | `mkdocs`, `mkdocs-material` (рекомендуется) |
| Работа с кастомными OpenAI-эндпоинтами | `requests`, `urllib3` (обычно уже включены) |

## Переменные окружения

Критически важные переменные, влияющие на работу инструмента:

```bash
# Обязательные
OPENAI_API_KEY=your_api_key_here

# Опциональные (с значениями по умолчанию)
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=1200
OPENAI_CONTEXT_TOKENS=8192
OPENAI_TEMPERATURE=0.2

# Параметры выполнения
AI_DOCS_THREADS=4
AI_DOCS_LOCAL_SITE=false
```

> **Примечание:** Все переменные можно переопределить через CLI-флаги (например, `--threads`, `--local-site`).

## Локальные файлы конфигурации

| Файл | Назначение | Автосоздание |
|------|----------|--------------|
| `.ai-docs.yaml` | Кастомизация расширений, фильтрации, исключений | Да |
| `.env` | Хранение `OPENAI_API_KEY` и других переменных | Нет (рекомендуется) |
| `.gitignore` | Учитывается при сканировании | Зависит от проекта |
| `.build_ignore` | Дополнительные правила исключения | Нет |

## Кэширование и временные файлы

- **`.ai_docs_cache/`** — директория с кэшем LLM-ответов (`llm_cache.json`) и индексом файлов (`index.json`). Создаётся автоматически.
- **Временные директории** — используются при клонировании репозиториев по URL, удаляются после завершения.

> **Рекомендация:** Добавьте `.ai_docs_cache/` в `.gitignore`, чтобы не коммитить кэш.
