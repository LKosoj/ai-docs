# Зависимости

```markdown
## Зависимости

Инструмент `ai_docs` использует следующие внешние и внутренние зависимости для обеспечения функциональности генерации технической документации.

### Внешние зависимости (PyPI)

| Пакет | Назначение | Обязательность |
|------|-----------|---------------|
| `tiktoken` | Подсчёт и разбиение текста на токены по модели LLM | Обязательно |
| `requests` | HTTP-запросы к API языковых моделей | Обязательно |
| `pyyaml` | Парсинг и генерация `mkdocs.yml` | Обязательно |
| `pathspec` | Обработка шаблонов игнорирования в стиле `.gitignore` | Обязательно |
| `click` | Реализация CLI-интерфейса | Обязательно |

Установка:  
```bash
pip install tiktoken requests pyyaml pathspec click
```

### Встроенные модули

Следующие модули являются частью ядра `ai_docs` и взаимодействуют между собой:

| Модуль | Зависимости | Назначение |
|-------|------------|----------|
| `ai_docs.scanner` | `pathspec`, `ai_docs.utils` | Сканирование файлов с фильтрацией по `.gitignore`, `.build_ignore`, размеру и типу |
| `ai_docs.llm` | `requests`, `tiktoken`, `ai_docs.utils` | Клиент для LLM с кэшированием и управлением контекстом |
| `ai_docs.generator` | `ai_docs.llm`, `ai_docs.cache`, `ai_docs.scanner`, `ai_docs.mkdocs` | Основная логика генерации документации |
| `ai_docs.mkdocs` | `pyyaml` | Генерация `mkdocs.yml` и структуры навигации |
| `ai_docs.cache` | `ai_docs.utils` | Управление кэшем LLM и индексацией файлов |
| `ai_docs.changes` | — | Форматирование отчёта об изменениях в `changes.md` |
| `ai_docs.utils` | — | Вспомогательные функции: хеширование, безопасные слаги, работа с путями |
| `ai_docs.tokenizer` | `tiktoken` | Разделение текста на чанки по лимиту токенов |

### Условные зависимости

| Функция | Требуемый пакет | Описание |
|--------|----------------|--------|
| Локальный запуск `mkdocs serve` | `mkdocs` | Необходим для `--local-site` и просмотра документации |
| Поддержка Mermaid-диаграмм | `mkdocs-mermaid2` | Добавляется в `plugins` в `mkdocs.yml` |

Установка для разработки и просмотра:  
```bash
pip install mkdocs mkdocs-mermaid2
```

### Интеграции с инфраструктурными технологиями

Инструмент автоматически распознаёт следующие технологии по наличию файлов и содержимому:

| Технология | Критерии обнаружения |
|-----------|---------------------|
| Docker | `Dockerfile`, `docker-compose.yml` |
| Kubernetes | `deployment.yaml`, `kustomization.yaml`, `apiVersion: apps/v1` |
| Helm | `Chart.yaml`, `values.yaml`, путь `/charts/` |
| Terraform | `.tf`, `.tfvars` |
| Ansible | Путь `/roles/`, `/tasks/`, `ansible` в пути |
| CI/CD | `.gitlab-ci.yml`, `Jenkinsfile`, `.github/workflows/` |

Эти технологии влияют на генерацию разделов документации, но не требуют отдельных зависимостей.

### Ограничения и совместимость

- **Python**: 3.8+ (требуется для `pathlib`, `typing`, `concurrent.futures`)
- **LLM API**: Совместим с OpenAI-совместимыми эндпоинтами (например, OpenAI, Azure OpenAI, локальные LLM через `llama.cpp` с флагом `/v1`)
- **Файловые системы**: Полностью поддерживает Unix и Windows (через `Path` и `to_posix`)
```
