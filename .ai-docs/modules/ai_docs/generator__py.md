# ai_docs/generator

Модуль отвечает за генерацию и управление документацией проекта на основе анализа исходных файлов, метаданных и контекста. Он автоматически создаёт структуру документации, включая индекс, модули, конфигурации, зависимости и изменения. Поддерживает асинхронную генерацию секций, обновление навигации, очистку устаревших файлов и интеграцию с MkDocs. Результат сохраняется в файловую систему с опциональным кэшированием.

Ключевые структуры данных  
file_map — карта файлов проекта с метаданными, включая тип, пути к сводкам и другую аналитическую информацию  
docs_files — словарь, содержащий сгенерированные документы в формате путь → содержимое  
regenerated_sections — список названий секций, перегенерированных в текущем запуске  
llm_cache — кэш результатов запросов к языковой модели для ускорения повторной генерации

---
_submit_section  
Создаёт и отправляет задачу на генерацию секции документации с указанным путём, заголовком и контекстом  
Аргументы  
path — относительный путь к файлу документа  
title — заголовок секции  
context — текстовый контекст, используемый для генерации содержимого  
Возвращает  
None  
Исключения  
RuntimeError — если возникла ошибка при отправке задачи в исполнитель

---
_generate_section  
Генерирует текстовую секцию документации с использованием языковой модели и кэширования  
Аргументы  
llm — экземпляр языковой модели  
llm_cache — кэш для хранения результатов предыдущих запросов  
title — заголовок секции  
context — контекстный текст для анализа  
language — язык вывода (например, 'ru', 'en')  
Возвращает  
Сгенерированный текст секции в виде строки  
Исключения  
Exception — при ошибках взаимодействия с языковой моделью

---
_render_project_configs_index  
Формирует содержимое индексной страницы конфигураций на основе списка путей  
Аргументы  
nav_paths — список строк с путями к страницам конфигураций  
Возвращает  
Строка в формате Markdown с оглавлением и структурой навигации  
Исключения  
None

---
_collect_dependencies  
Извлекает список зависимостей проекта из карты файлов  
Аргументы  
file_map — словарь с информацией о файлах проекта  
Возвращает  
Список строк, каждая из которых представляет собой зависимость  
Исключения  
None

---
format_changes_md  
Форматирует Markdown-представление изменений в проекте (добавленные, изменённые, удалённые файлы)  
Аргументы  
added — словарь добавленных файлов  
modified — словарь изменённых файлов  
deleted — словарь удалённых файлов  
regenerated_sections — список перегенерированных секций  
summary — краткое резюме изменений  
Возвращает  
Строка в формате Markdown с детализацией изменений  
Исключения  
None

---
_build_docs_index  
Строит JSON-индекс документации для навигации и структуры сайта  
Аргументы  
output_root — корневой путь вывода  
docs_dir — директория с документацией  
docs_files — текущие сгенерированные файлы документации  
file_map — карта исходных файлов  
module_pages — страницы модулей  
config_pages — страницы конфигураций  
Возвращает  
Словарь, представляющий иерархию документации в формате JSON  
Исключения  
None

---
_generate_readme  
Генерирует содержимое README.md на основе контекста и метаданных проекта  
Аргументы  
llm — экземпляр языковой модели  
llm_cache — кэш запросов к языковой модели  
project_name — имя проекта  
overview_context — общий контекст для описания проекта  
language — язык генерации  
Возвращает  
Строка с содержимым README в формате Markdown  
Исключения  
Exception — при ошибках генерации текста

---
build_mkdocs_yaml  
Формирует содержимое файла mkdocs.yml на основе структуры документации  
Аргументы  
site_name — имя сайта документации  
sections — отображение заголовков секций  
configs — список записанных конфигураций  
has_modules — флаг наличия модулей  
module_nav_paths — пути навигации по модулям  
project_config_nav_paths — пути навигации по конфигурациям  
local_site — флаг локального размещения сайта  
Возвращает  
Строка в формате YAML с конфигурацией MkDocs  
Исключения  
None

---
write_docs_files  
Записывает все сгенерированные файлы документации в указанную директорию  
Аргументы  
docs_dir — директория назначения  
docs_files — словарь с путями и содержимым файлов  
Возвращает  
None  
Исключения  
OSError — при ошибках записи файлов

---
class DOMAIN_TITLES  
Словарь соответствия доменов и их локализованных заголовков в документации  
Поля  
(строковые ключи) — например, "auth", "billing" и т.д.  
(строковые значения) — локализованные названия разделов, например "Аутентификация"  
Методы  
None

---
class SECTION_TITLES  
Хранит стандартные заголовки секций документации в локализованном виде  
Поля  
dependencies — заголовок секции зависимостей  
Методы  
None
