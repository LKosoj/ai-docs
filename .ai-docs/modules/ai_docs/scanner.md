# ai_docs/scanner

/**
 * @brief Модуль для сканирования исходных кодов из локальной директории или удалённого репозитория.
 *
 * Осуществляет рекурсивный обход файловой системы с поддержкой фильтрации по шаблонам включения и исключения,
 * включая обработку .gitignore и других ignore-файлов. Поддерживает клонирование Git-репозиториев по URL.
 * Для каждого файла определяет тип, домены, содержимое и метаданные, исключая бинарные и слишком большие файлы.
 *
 * Ключевые структуры данных
 * ScanResult — результат сканирования исходного кода, содержащий список файлов и метаданные
 */

class ScanResult
Результат сканирования исходного кода — содержит список файлов и метаданные сканирования.
Поля
root — корневой путь сканирования (абсолютный)
files — список словарей с информацией о каждом проанализированном файле
source — исходный URL или путь, переданный на вход
repo_name — имя репозитория (из URL или имени директории)
Методы
---  
_load_ignore_specs
Загружает и компилирует правила игнорирования из .gitignore и .build_ignore в текущем корне.
Аргументы
root — корневая директория сканирования
Возвращает
Список скомпилированных pathspec.PathSpec, готовых к сопоставлению с путями
Исключения

---  
_should_include
Проверяет, должен ли файл быть включён в результаты сканирования.
Аргументы
rel_path — относительный путь к файлу в формате POSIX
include — пользовательские шаблоны включения (если None — включаются все, кроме исключённых)
exclude — пользовательские шаблоны исключения
ignore_specs — список скомпилированных спецификаций игнорирования (например, из .gitignore)
Возвращает
True, если файл должен быть включён; False, если должен быть пропущен
Исключения

---  
_scan_directory
Рекурсивно сканирует директорию и возвращает список проанализированных файлов.
Аргументы
root — корневая директория для сканирования
include — набор шаблонов для включения файлов
exclude — набор шаблонов для исключения файлов
max_size — максимальный размер файла в байтах (превышающие игнорируются)
Возвращает
Список словарей с информацией о каждом включённом файле: путь, размер, содержимое, тип, домены
Исключения

---  
_clone_repo
Клонирует Git-репозиторий в временный каталог.
Аргументы
repo_url — URL Git-репозитория (HTTP/HTTPS)
Возвращает
Кортеж из (путь_к_временной_директории, имя_репозитория)
Исключения
RuntimeError — если клонирование завершилось с ошибкой

---  
scan_source
Основная функция модуля: запускает сканирование по заданному источнику (URL или путь).
Аргументы
source — путь к локальной директории или URL удалённого репозитория
include — дополнительные шаблоны для включения файлов (по умолчанию — DEFAULT_INCLUDE_PATTERNS)
exclude — дополнительные шаблоны для исключения файлов (по умолчанию — DEFAULT_EXCLUDE_PATTERNS)
max_size — максимальный размер файла в байтах (по умолчанию 200 КБ)
Возвращает
Объект ScanResult с результатами сканирования
Исключения
FileNotFoundError — если локальный путь не существует
RuntimeError — если не удалось клонировать репозиторий
