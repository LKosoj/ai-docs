# ai_docs/generator_output

```markdown
Модуль отвечает за финальную сборку и запись документации в файловую систему, включая генерацию индекса, обновление статических ресурсов (например, Mermaid.js), очистку устаревших файлов, постобработку HTML-выхода и интеграцию с MkDocs. Основные функции включают запись файлов документации, генерацию конфигурации MkDocs и обновление README. Модуль также обеспечивает поддержку динамического индексирования и корректное встраивание диаграмм Mermaid в итоговую документацию.

Ключевые структуры данных
docs_files — словарь, сопоставляющий относительные пути файлов с их содержимым в виде строки
file_map — словарь с информацией о сопоставлении исходных файлов и генерируемых страниц
module_pages — словарь, содержащий сгенерированные страницы модулей по ключам
config_pages — словарь, содержащий сгенерированные страницы конфигураций по ключам

add_mermaid_asset(docs_files: Dict[str, str]) -> None
Добавляет Mermaid.js в набор статических файлов документации, если ресурс доступен
Аргументы
docs_files — словарь файлов документации, в который будет добавлен скрипт mermaid.min.js
Исключения
Нет

---
write_docs(output_root: Path, docs_dir: Path, docs_files: Dict[str, str], file_map: Dict[str, Dict], module_pages: Dict[str, str], config_pages: Dict[str, str], has_changes: bool) -> None
Генерирует и записывает файлы документации, включая индекс и статические ресурсы, и удаляет устаревшие файлы
Аргументы
output_root — корневая директория проекта
docs_dir — директория, куда записываются документы
docs_files — словарь с содержимым файлов документации
file_map — карта соответствия исходных файлов и страниц документации
module_pages — сгенерированные страницы модулей
config_pages — сгенерированные страницы конфигураций
has_changes — флаг, указывающий на наличие изменений в исходных данных
Исключения
Нет

---
write_readme(output_root: Path, readme: str, force: bool) -> None
Записывает или перезаписывает файл README.md в корне проекта
Аргументы
output_root — корневая директория проекта
readme — содержимое README в формате Markdown
force — если True, перезаписывает существующий файл
Исключения
Нет

---
build_mkdocs(output_root: Path, module_nav_paths: List[str], config_nav_paths: List[str], configs_written: Dict[str, str], write_mkdocs: bool, local_site: bool) -> None
Генерирует конфигурацию MkDocs, собирает статический сайт и выполняет постобработку HTML
Аргументы
output_root — корневая директория проекта
module_nav_paths — пути к страницам модулей для навигации
config_nav_paths — пути к страницам конфигураций для навигации
configs_written — словарь записанных файлов конфигураций
write_mkdocs — флаг, разрешающий сборку сайта MkDocs
local_site — если True, настраивает сайт для локального размещения
Исключения
RuntimeError — если mkdocs не установлен и не найден в системе

---
_postprocess_mermaid_html(site_dir: Path) -> None
Выполняет постобработку HTML-файлов сайта: исправляет escape-последовательности в блоках Mermaid
Аргументы
site_dir — директория с собранным сайтом MkDocs
Исключения
Нет

---
__serialize_index(index: Dict[str, object]) -> str
Сериализует индекс документации в JSON с добавлением метаданных о времени генерации и правилах поиска
Аргументы
index — исходный словарь индекса документации
Возвращает
Строка в формате JSON с дополнительными метаданными
Исключения
Нет
```
