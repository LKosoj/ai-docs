# ai_docs/cache

```markdown
Модуль предоставляет класс `CacheManager` для управления кэшем файлов и промптов в виде JSON-файлов на диске.  
Он отвечает за хранение и загрузку индекса файлов и кэша ответов LLM, а также вычисление различий между текущим и предыдущим состояниями файлов.  
Кэш разделяется на два файла: один для метаданных файлов, другой — для кэшированных ответов модели.

Ключевые структуры данных  
Dict — Словарь, представляющий индекс файлов с ключами "files" и "sections", где "files" содержит метаданные по файлам, а "sections" — информацию о секциях.  
Dict[str, str] — Кэш ответов LLM, где ключ — хэш промпта, значение — ответ модели.

class CacheManager  
Менеджер кэша для хранения и синхронизации метаданных файлов и кэша LLM.  
Поля  
cache_dir — Директория, в которой хранятся файлы кэша.  
index_path — Путь к файлу index.json с метаданными файлов и секций.  
llm_cache_path — Путь к файлу llm_cache.json с кэшированными ответами LLM.  
Методы  
__init__(self, cache_dir: Path) — Инициализирует менеджер кэша, создает директорию и устанавливает пути к файлам кэша.  
---
load_index(self) -> Dict  
Загружает индекс файлов из index.json или возвращает пустую структуру по умолчанию.  
Возвращает  
Словарь с данными индекса: файлы и секции.  
---
save_index(self, data: Dict) -> None  
Сохраняет переданный словарь в index.json.  
Аргументы  
data — Данные индекса для сохранения.  
---
load_llm_cache(self) -> Dict[str, str]  
Загружает кэш ответов LLM из llm_cache.json или возвращает пустой словарь.  
Возвращает  
Словарь с кэшированными ответами LLM.  
---
save_llm_cache(self, data: Dict[str, str]) -> None  
Сохраняет кэш ответов LLM в llm_cache.json.  
Аргументы  
data — Словарь с кэшем промптов и ответов.  
---
diff_files(self, current_files: Dict[str, Dict]) -> Tuple[Dict, Dict, Dict, Dict]  
Сравнивает текущие файлы с предыдущим состоянием и возвращает списки добавленных, изменённых, удалённых и неизменённых файлов.  
Аргументы  
current_files — Текущие метаданные файлов, где ключ — путь, значение — словарь с метаданными (включая хэш).  
Возвращает  
Кортеж из четырёх словарей: добавленные, изменённые, удалённые, неизменённые файлы.
```
