# Глоссарий

В этом разделе приведены ключевые термины и понятия, используемые в системе `ai_docs`, с краткими определениями и практическим контекстом применения.

---

## **AI-документация**
Автоматически генерируемая техническая документация на основе анализа исходного кода, конфигураций и метаданных проекта с использованием LLM.  
**Практическое применение**: Снижает трудозатраты на поддержку актуальной документации, особенно в активно развивающихся проектах.

---

## **LLM (Large Language Model)**
Языковая модель, используемая для генерации текста документации. В `ai_docs` поддерживается через OpenAI-совместимые API.  
**Конфигурация**:  
- `OPENAI_API_KEY` — обязательный ключ доступа.  
- `OPENAI_MODEL` — модель по умолчанию (`gpt-4o-mini`).  
- `OPENAI_BASE_URL` — позволяет использовать кастомные эндпоинты (например, локальные LLM).  

---

## **Кэширование**
Механизм хранения промежуточных результатов для ускорения повторной генерации.  
**Файлы кэша**:  
- `.ai_docs_cache/llm_cache.json` — ответы LLM (ключ — хеш запроса).  
- `.ai_docs_cache/index.json` — хэши файлов и метаданные.  
**Флаги CLI**: `--no-cache` — отключает использование кэша.

---

## **CacheManager**
Класс, управляющий кэшем файлов. Сравнивает текущее состояние файлов с предыдущим, определяя:  
- `added` — новые файлы,  
- `modified` — изменённые,  
- `deleted` — удалённые,  
- `unchanged` — без изменений.  
**Использование**: Инкрементальная обработка — перегенерируются только изменённые разделы.

---

## **ScanResult**
Объект, возвращаемый сканером. Содержит:  
- `root` — корневая директория,  
- `files` — список файлов с метаданными (путь, размер, тип),  
- `source` — исходный путь или URL,  
- `repo_name` — имя репозитория (если источник — Git).  
**Применение**: Входные данные для генерации документации.

---

## **.ai-docs.yaml**
Конфигурационный файл для настройки сканирования. Поддерживает:  
- `code_extensions`, `doc_extensions`, `config_extensions` — кастомные расширения,  
- `exclude` — дополнительные шаблоны исключения.  
**Поведение по умолчанию**: Файл создаётся автоматически при первом запуске.

---

## **.gitignore и .build_ignore**
Файлы с правилами игнорирования. Используются при сканировании:  
- `.gitignore` — стандартные правила проекта,  
- `.build_ignore` — дополнительные правила, специфичные для `ai_docs`.  
**Инструмент**: `pathspec` — обработка glob-паттернов.

---

## **MkDocs**
Генератор статических сайтов документации. `ai_docs` создаёт:  
- `mkdocs.yml` — конфигурация навигации и плагинов,  
- `docs/` — выходная директория с Markdown-файлами.  
**Плагины**: `mkdocs-mermaid2-plugin` (диаграммы), `pymdown-extensions` (расширенный Markdown).

---

## **README.md**
Краткая документация проекта, генерируется в корне. Включает:  
- Описание проекта,  
- Архитектуру (Mermaid-диаграммы),  
- Зависимости,  
- Инструкции по запуску.  
**Флаг**: `--readme` — включает генерацию.

---

## **Токенизация**
Разбиение текста на токены для совместимости с ограничениями LLM.  
**Инструмент**: `tiktoken`.  
**Функции**:  
- `count_tokens()` — подсчёт токенов,  
- `chunk_text()` — разделение текста на части по `max_tokens`.  
**Применение**: Обработка больших файлов без превышения лимита контекста.

---

## **DOMAIN_TITLES, SECTION_TITLES**
Словари локализованных заголовков. Позволяют генерировать документацию на разных языках.  
**Поддерживаемые языки**: `ru`, `en` (по умолчанию `ru`).  
**Флаг**: `--language ru`.

---

## **Инфраструктурные домены**
Автоматически распознаваемые технологические области:  
- `kubernetes`, `helm`, `terraform`, `docker`, `ci/cd`, `observability`, `service-mesh`, `data-storage`.  
**Определение**: По расширениям, именам файлов и путям (например, `Dockerfile`, `.tf`, `k8s/`).  
**Использование**: Классификация модулей и генерация релевантных разделов.

---

## **.ai_docs_cache/**
Директория для хранения кэша. Содержит:  
- `llm_cache.json` — закэшированные ответы LLM,  
- `index.json` — хэши файлов.  
**Очистка**: При использовании `--force` или ручном удалении.

---

## **.ai-docs/**
Рабочая директория с промежуточными артефактами:  
- `_index.json` — навигационный индекс,  
- `changes.md` — отчёт об изменениях,  
- `glossary.md`, `dependencies.md` — сгенерированные разделы.  
**Важно**: Не удалять вручную — используется для инкрементальной обработки.

---

## **--local-site**
Флаг, включающий режим локальной сборки без публикации.  
**Эффект**: В `mkdocs.yml` отключается деплой, включается `site_dir: site`.  
**Переменная окружения**: `AI_DOCS_LOCAL_SITE=1`.

---

## **--threads**
Количество потоков для параллельной обработки файлов.  
**По умолчанию**: 4.  
**Переменная окружения**: `AI_DOCS_THREADS`.  
**Рекомендация**: Увеличивать на мощных машинах для ускорения анализа.

---

## **FIXED_INCLUDE_PATTERNS**
Список шаблонов, которые всегда включаются в сканирование, даже если игнорируются `.gitignore`.  
**Примеры**: `*.tf`, `Dockerfile`, `package.json`, `requirements.txt`, `*.yaml` в `k8s/`.  
**Цель**: Гарантированное обнаружение ключевых конфигурационных файлов.

---

## **DEFAULT_EXCLUDE_PATTERNS**
Стандартные шаблоны исключения:  
- `.git`, `__pycache__`, `.venv`, `node_modules`, `dist`, `build`, `.env`.  
**Цель**: Исключение артефактов сборки и временных данных.

---

## **summarize_file()**
Основная функция генерации резюме файла. Поддерживает режимы:  
- `summary` — краткое описание,  
- `module` — анализ кода,  
- `config` — разбор конфигурации.  
**Нормализация**: Выход приводится к строгому формату через `_normalize_*`.

---

## **_build_tree_nav()**
Функция построения древовидной навигации для MkDocs. Преобразует плоский список путей в вложенную структуру.  
**Пример**: `modules/api/handlers.py` → `Modules > API > Handlers`.

---

## **changes.md**
Автоматически обновляемый отчёт о внесённых изменениях. Содержит:  
- Добавленные/изменённые/удалённые файлы,  
- Перегенерированные разделы,  
- Итоговое резюме.  
**Источник**: Результат `CacheManager.diff_files()`.

---
