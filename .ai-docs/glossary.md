# Глоссарий

Ниже приведены ключевые термины и сущности, используемые в системе `ai_docs`, с краткими определениями и практическим контекстом применения.

---

## `ScanResult`
Объект, содержащий результат сканирования исходного кода. Включает:
- Список файлов с метаданными: путь, размер, тип (код/конфиг/документация), домены (например, `kubernetes`, `terraform`), первые 4000 символов содержимого.
- Корневой путь и имя репозитория.
- Используется как вход для генерации документации.

> **Практическое применение**: Передаётся в `generate_docs` для анализа структуры проекта и определения контекста.

---

## `LLMClient`
Клиент для взаимодействия с LLM через API. Поддерживает:
- Отправку чат-запросов к OpenAI-совместимым эндпоинтам.
- Кэширование ответов по SHA256-хешу payload.
- Настройку модели, температуры, лимитов токенов.

> **Практическое применение**: Используется в `summarize_file` для генерации описаний файлов. Кэширование ускоряет повторную обработку.

---

## `.ai_docs_cache/`
Директория для хранения закэшированных ответов LLM. Управляется `CacheManager`.

> **Практическое применение**: При повторном запуске `ai_docs` повторные запросы к LLM не выполняются, если содержимое файла не изменилось.

---

## `.ai-docs/`
Рабочая директория инструмента. Содержит:
- `_index.json` — навигационный индекс проекта.
- `changes.md` — отчёт об изменениях после генерации.
- `glossary.md`, `dependencies.md`, `modules/`, `configs/` — сгенерированные документы.
- `mkdocs.yml` — конфигурация сайта (если включён режим MkDocs).

> **Практическое применение**: Используется как источник данных для локальной навигации и рефакторинга. Не коммитится в репозиторий, если не требуется.

---

## `file_map`
Структура данных, сопоставляющая каждый файл с его метаданными:
- Тип (код, конфиг, документация),
- Обнаруженные домены,
- Хэш содержимого,
- Путь к сгенерированной сводке (`.ai-docs/summaries/...`).

> **Практическое применение**: Основа для определения, какие файлы нужно пересуммаризировать при инкрементальной обработке.

---

## Домены (Domains)
Логические группы технологий, автоматически распознаваемые в проекте:
- `kubernetes`, `helm`, `terraform`, `ansible`, `docker`, `ci/cd`, `observability`, `service-mesh`, `data-storage`.

> **Практическое применение**: Используются для структурирования документации и генерации релевантных разделов (например, "Инфраструктура как код").

---

## `summarize_file`
Функция, генерирующая краткое описание файла с помощью LLM. Поддерживает режимы:
- Базовое резюме,
- Описание модуля,
- Описание конфигурации.

> **Практическое применение**: Вызывается параллельно для всех файлов. Результат сохраняется в Markdown и используется в `README.md` и `modules/`.

---

## `chunk_text`
Утилита разбиения текста на части по токенам. Использует `tiktoken` для точного подсчёта.

> **Практическое применение**: Применяется при обработке больших файлов, превышающих лимит контекста модели (например, 8192 токенов).

---

## `CacheManager`
Класс для управления кэшем:
- `index.json` — хранит хэши файлов и их метаданные.
- `llm_cache.json` — хранит ответы LLM.
- Метод `diff_files()` определяет, какие файлы изменились, добавлены или удалены.

> **Практическое применение**: Определяет, какие файлы нужно перепроцессировать при запуске с кэшированием.

---

## `mkdocs.yml`
Генерируемый конфигурационный файл для MkDocs. Включает:
- Навигацию по разделам,
- Плагины (например, `mermaid2`),
- Расширения Markdown.

> **Практическое применение**: Автоматически создаётся при флаге `--mkdocs`. Используется для сборки сайта документации.

---

## `changes.md`
Автоматически генерируемый отчёт в формате Markdown. Содержит:
- Список добавленных, изменённых, удалённых файлов,
- Перечень перегенерированных разделов,
- Итоговое резюме изменений.

> **Практическое применение**: Полезен при интеграции в CI/CD для аудита изменений в документации.

---

## `.ai-docs.yaml`
Конфигурационный файл проекта. Позволяет:
- Добавлять пользовательские расширения файлов,
- Задавать правила включения/исключения,
- Настроить поведение сканера.

> **Практическое применение**: Используется для тонкой настройки анализа, например, включения `.tfvars` как конфигурационных файлов.

---

## `SECTION_TITLES`, `DOMAIN_TITLES`
Словари с локализованными заголовками разделов и доменов (поддержка `ru`, `en`).

> **Практическое применение**: Обеспечивают соответствие языка документации заданному через `--language`.

---

## `ensure_dir`
Утилита для безопасного создания директорий. Проверяет существование, создаёт все промежуточные папки.

> **Практическое применение**: Используется перед записью любых выходных файлов, например, в `write_docs_files`.

---

## `classify_type`, `detect_domains`
Функции классификации файлов по:
- Типу (код, конфиг, документация) — на основе расширений и имён.
- Доменам — по ключевым словам в пути или содержимом (например, `Dockerfile` → `docker`).

> **Практическое применение**: Определяют, как обрабатывать и в какие разделы включать файл.
