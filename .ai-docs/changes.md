# Изменения с последней генерации

## Добавленные файлы

- нет
## Изменённые файлы

- ai_docs/generator_cache.py
- ai_docs/generator_output.py
- ai_docs/mkdocs.py
## Удалённые файлы

- нет
## Перегенерированные разделы

- Тестирование
- Зависимости
- Запуск и окружение
- Соглашения
- Модули
- Конфигурация проекта
- Глоссарий
- Архитектура
- Документация проекта

## Краткое резюме

- Добавлена поддержка инкрементальной генерации документации через систему кэширования на основе хешей файлов (`sha256_text`). Неизменённые файлы переносят существующие сводки, избегая повторной обработки.
- Внедрён `CacheManager` для управления кэшем LLM-ответов и индекса файлов. При включённом `use_cache` сохраняются и восстанавливаются промежуточные результаты.
- Реализовано сравнение файлов через `diff_files`, определяющее изменения по хешам. Учитываются добавленные, изменённые и удалённые файлы.
- Автоматическая очистка устаревших сводок: `cleanup_orphan_summaries` и `cleanup_deleted_summaries` удаляют неиспользуемые файлы из промежуточных директорий (`files`, `modules`, `configs`) с детальным логированием.
- Динамическая генерация `mkdocs.yml` через `build_mkdocs_yaml` с поддержкой вложенной навигации, включая разделы: архитектура, конфиги, модули, тестирование, глоссарий и др.
- Навигация строится по дереву с `_build_tree_nav`, преобразующим пути в иерархическую структуру для модулей и конфигураций.
- Добавлена интеграция Mermaid.js: включён плагин `mermaid2` и расширение `pymdownx.superfences`. HTML-постобработка через `_postprocess_mermaid_html` корректирует спецсимволы в диаграммах.
- Генерация индекса поиска через `__serialize_index` с метаданными: время сборки, приоритеты файлов для ранжирования.
- Поддержка локальной разработки: `site_url` и `use_directory_urls` настраиваются при локальной сборке.
- Запись файлов документации (`write_docs`) включает фильтрацию по `keep_files` и очистку неиспользуемых файлов.
- Используется кастомный `_YamlSafeDumper` для корректной сериализации сложных типов (например, `mermaid2.fence_mermaid`).
- `write_readme` обновляет `README.md`, обеспечивая синхронность с основной документацией.
- Промежуточные сводки хранятся в структурированных директориях, фильтрация тестовых файлов — через `is_test_path`.
