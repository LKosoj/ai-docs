# Изменения с последней генерации

## Добавленные файлы

- нет
## Изменённые файлы

- README.md
- pyproject.toml
## Удалённые файлы

- нет
## Перегенерированные разделы

- Тестирование
- Модули
- Конфигурация проекта
- Зависимости
- Запуск и окружение
- Соглашения
- Архитектура
- Глоссарий
- Документация проекта

## Краткое резюме

После анализа кодовой базы и состояния проекта, ниже приведены ключевые изменения и особенности поведения инструмента `ai_docs`, актуальные на текущий момент.

## Изменения в структуре и поведении

- **Кэширование и инкрементальная обработка**:  
  Результаты анализа файлов кэшируются в директории `.ai_docs_cache/`. При повторном запуске обрабатываются только изменённые или новые файлы. Это значительно ускоряет генерацию документации в больших проектах.

- **Хранение промежуточных данных**:  
  Все служебные файлы (навигационный индекс, отчёт изменений, конфигурации) сохраняются в `.ai-docs/`. Включает:
  - `changes.md` — отчёт о внесённых изменениях в структуру проекта и документации.
  - `navigation_index.json` — автоматически построенный индекс структуры проекта.
  - `summary.json` — суммаризация по компонентам и доменам.

- **Автоматическое распознавание технологий**:  
  Инструмент определяет используемые технологии по наличию характерных файлов:
  - **Kubernetes / Helm**: `deployment.yaml`, `Chart.yaml`
  - **Terraform**: `.tf`-файлы, `main.tf`
  - **Ansible**: `playbook.yml`, `inventory/`
  - **Docker**: `Dockerfile`, `docker-compose.yml`
  - **CI/CD**: `.gitlab-ci.yml`, `.github/workflows/`
  - **Observability**: `prometheus.yml`, `grafana/`
  - **Service Mesh / Ingress**: `istio`, `ingress-nginx`
  - **Data / Storage**: `kafka`, `postgres`, `redis`, `minio`

- **Фильтрация файлов**:  
  Используется комбинация:
  - Правил из `.gitignore`
  - Стандартных исключений: `.venv`, `node_modules`, `dist`, `build`, `.ai-docs`, `.git`
  - Пользовательских правил из `.ai-docs.yaml` (через поля `exclude`, `include`)

- **Поддержка локальных и удалённых репозиториев**:  
  Флаг `--source` принимает:
  - Путь к локальной директории
  - URL Git-репозитория (например, `https://github.com/user/repo.git`)
  - Поддержка SSH- и HTTPS-ссылок, с опциональным указанием ветки/тега

- **Гибкая генерация документации**:  
  - `--readme` — генерирует только `README.md` в корне
  - `--mkdocs` — генерирует полный сайт документации (включая `mkdocs.yml`, `docs/`)
  - Без флагов — генерируется полный комплект

- **Поддержка LLM-провайдеров**:  
  Через переменные окружения:
  ```bash
  OPENAI_API_KEY=...
  OPENAI_BASE_URL=https://api.openai.com/v1
  OPENAI_MODEL=gpt-4o-mini
  ```
  Поддерживается любой OpenAI-совместимый эндпоинт (например, Azure, Ollama, LocalAI).

- **Параллельная обработка**:  
  Количество потоков задаётся через:
  - Переменную окружения `AI_DOCS_THREADS`
  - Флаг `--threads N` (приоритет выше)
  - По умолчанию: `min(4, CPU_CORES)`

- **Режим локальной сборки**:  
  При установке `AI_DOCS_LOCAL_SITE=1` или флаге `--local-site`:
  - Сайт генерируется, но не публикуется
  - Отключаются шаги деплоя (например, `gh-pages`)
  - Полезно для CI/CD-отладки

- **Принудительная перегенерация**:  
  Флаг `--force` игнорирует кэш и пересоздаёт все файлы.

- **Отключение кэширования**:  
  Флаг `--no-cache` — временно отключает чтение из кэша, но не удаляет его.

## Конфигурация через `.ai-docs.yaml`

Поддерживаемые параметры:
```yaml
extensions:
  - py
  - ts
  - terraform
exclude:
  - "tests/"
  - "scripts/internal/"
include:
  - "config/production.yaml"
language: ru  # или en
```

## Генерация отчёта изменений

Файл `.ai-docs/changes.md` содержит:
- Список добавленных/удалённых файлов
- Обнаруженные технологические сдвиги (например, добавление Helm-чарта)
- Изменения в структуре проекта
- Рекомендации по актуализации документации

## Требования к окружению

- Python ≥ 3.8
- Доступ к LLM через API
- Установленный `mkdocs` (если используется `--mkdocs`)
- Сетевой доступ при работе с удалёнными репозиториями

---

> **Примечание**: Все изменения отслеживаются детерминированно. Повторный запуск на одной и той же версии кода даст идентичный результат при одинаковых входных параметрах.
